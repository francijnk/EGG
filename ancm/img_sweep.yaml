# wandb sweep --project cezary_test IMG_SWEEP.YAML
program: train.py
name: img
method: bayes
metric:
  goal: maximize
  name: test/accuracy
parameters:
  optim:
    values: ['adam', 'rmsprop']
  sender_lr:
    min: !!float 1e-4
    max: !!float 1e-2
  receiver_lr:
    min: !!float 1e-4
    max: !!float 1e-2
  temperature_lr:
    min: !!float 1e-6
    max: !!float 1e-3
  temperature:
    min: !!float 2
    max: !!float 5
early_terminate:
  eta: 1.5
  min_iter: 150
  strict: true
  type: hyperband

command:  
- python3
- -m 
- ancm.train
- --embedding=16
- --temperature_minimum=1.
- --image_input
- --results_folder=runs/
- --data_path=ancm/data/input_data/obverter-5-256-64.npz
- --wandb_entity=koala_lab
- --wandb_project=cezary_test
- --random_seed=42
- --sender_hidden=128
- --receiver_hidden=128
- --optim=rmsprop
- --filename=sweep
- --max_len=5
- --n_epochs=30
- --batch_size=32
- --length_cost=0.005
- ${args_no_boolean_flags}
